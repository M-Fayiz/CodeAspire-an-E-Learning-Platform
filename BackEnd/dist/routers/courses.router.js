"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = __importDefault(require("express"));
const CourseRepository_1 = require("../repository/implementation/CourseRepository");
const CourseService_1 = require("../services/implementation/CourseService");
const CourseController_1 = require("../controllers/implementation/CourseController");
const authentication_middleware_1 = require("../middlewares/authentication.middleware");
const authorisation_middleware_1 = require("../middlewares/authorisation.middleware");
const CategoryRepository_1 = require("../repository/implementation/CategoryRepository");
const EnrolledRepository_1 = require("../repository/implementation/EnrolledRepository");
const user_types_1 = require("../types/user.types");
const NotificationRepository_1 = require("../repository/implementation/NotificationRepository");
const ReviewRepository_1 = require("../repository/implementation/ReviewRepository");
const courseRepository = new CourseRepository_1.CourseRepository();
const categoryRepository = new CategoryRepository_1.CategoryRepository();
const enrolledRepositoy = new EnrolledRepository_1.EnrolledRepository();
const notificationRepository = new NotificationRepository_1.NotificationRepository();
const reviewRepository = new ReviewRepository_1.ReviewRepository();
const courseService = new CourseService_1.CourseService(courseRepository, categoryRepository, enrolledRepositoy, notificationRepository, reviewRepository);
const courseController = new CourseController_1.CourseController(courseService);
const courseRouter = express_1.default.Router();
courseRouter.get("/", courseController.fetchCourse);
courseRouter.use(authentication_middleware_1.verifyUser);
courseRouter.use((0, authorisation_middleware_1.authorizedRole)(user_types_1.IRole.Mentor, user_types_1.IRole.Admin, user_types_1.IRole.Learner));
courseRouter.post("/", courseController.addCourse);
courseRouter.get("/my-courses", courseController.getMentorDraftedCourseList);
courseRouter.get("/admin-courses", courseController.getAdminCoursList);
courseRouter.get("/:courseId", courseController.getCourse);
courseRouter.get("/:courseId/admin", courseController.getAdminCourseDetails);
courseRouter.get("/admin/:courseId", courseController.getCourseDetails);
courseRouter.get("/mentor/:mentorId", courseController.getCourseListSlot);
courseRouter.get("/form/:courseId", courseController.getCourseFormData);
// courseRouter.put("/:id", courseController.updateCourse);
courseRouter.put("/:courseId", courseController.updateBaseInfo);
courseRouter.put("/:courseId/sessions", courseController.addSession);
courseRouter.put("/:courseId/sessions/:sessionId", courseController.addLecture);
courseRouter.put("/:courseId/sessions/:sessionId/lectures/:lectureId", courseController.editLecture);
courseRouter.delete("/:courseId/session/:sessionId", courseController.removeSession);
courseRouter.patch("/publish/:courseId", courseController.publishCourse);
courseRouter.patch("/admin/approve/:courseId", courseController.approveCourse);
courseRouter.patch("/admin/reject/:courseId", courseController.rejectCourse);
exports.default = courseRouter;
